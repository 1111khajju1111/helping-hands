<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helping Hands - Blood Donation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #e63946 0%, #c1121f 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
        }

        .tab.active {
            color: #e63946;
            border-bottom: 3px solid #e63946;
        }

        .content {
            padding: 25px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.4s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 14px;
            transition: border 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #e63946;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #e63946 0%, #c1121f 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 57, 70, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .donor-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #e63946;
        }

        .donor-card h3 {
            font-size: 16px;
            margin-bottom: 8px;
            color: #333;
        }

        .donor-card p {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .blood-type {
            display: inline-block;
            background: #e63946;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            margin-top: 5px;
        }

        .status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .status.available {
            background: #d4edda;
            color: #155724;
        }

        .status.busy {
            background: #f8d7da;
            color: #721c24;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .emergency-btn {
            background: linear-gradient(135deg, #ff006e 0%, #d00000 100%);
            font-size: 18px;
            padding: 18px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .ai-section {
            background: linear-gradient(135deg, #667eea 0%, #ff4848 100%);
            padding: 15px;
            border-radius: 10px;
            color: white;
            margin-bottom: 20px;
        }

        .ai-section h3 {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .ai-response {
            background: rgba(255,255,255,0.2);
            padding: 12px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.5;
            margin-top: 10px;
            display: none;
        }

        .loader {
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .no-results {
            text-align: center;
            padding: 30px;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1> Helping Hands</h1>
            <p>Connecting Blood Donors & Recipients</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('register')">Register</button>
            <button class="tab" onclick="showTab('search')">Search</button>
            <button class="tab" onclick="showTab('emergency')">Emergency</button>
            <button class="tab" onclick="showTab('ai')">AI Help</button>
        </div>

        <div class="content">
            <!-- Register Section -->
            <div id="register" class="section active">
                <h2 style="margin-bottom: 20px; color: #333;">Register as Donor</h2>
                <form id="registerForm">
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" id="donorName" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="tel" id="donorPhone" placeholder="+91 9876543210" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="donorEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="form-group">
                        <label>Blood Group</label>
                        <select id="donorBloodGroup" required>
                            <option value="">Select Blood Group</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>City</label>
                        <input type="text" id="donorCity" placeholder="Your city" required>
                    </div>
                    <div class="form-group">
                        <label>Address</label>
                        <textarea id="donorAddress" rows="3" placeholder="Full address" required></textarea>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="availability" checked>
                        <label for="availability" style="margin-bottom: 0;">Available to donate now</label>
                    </div>
                    <button type="submit" class="btn btn-primary">Register as Donor</button>
                </form>
                <div id="registerAlert" style="margin-top: 15px;"></div>
            </div>

            <!-- Search Section -->
            <div id="search" class="section">
                <h2 style="margin-bottom: 20px; color: #333;">Search Donors</h2>
                <div class="form-group">
                    <label>Blood Group Needed</label>
                    <select id="searchBloodGroup">
                        <option value="">Select Blood Group</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>City</label>
                    <input type="text" id="searchCity" placeholder="Enter city">
                </div>
                <button class="btn btn-primary" onclick="searchDonors()">Search Donors</button>
                <div id="searchResults" style="margin-top: 20px;"></div>
            </div>

            <!-- Emergency Section -->
            <div id="emergency" class="section">
                <h2 style="margin-bottom: 20px; color: #333;">Emergency Request</h2>
                <div class="alert alert-danger">
                     Use only for urgent blood requirements
                </div>
                <form id="emergencyForm">
                    <div class="form-group">
                        <label>Patient Name</label>
                        <input type="text" id="patientName" placeholder="Patient's name" required>
                    </div>
                    <div class="form-group">
                        <label>Blood Group Required</label>
                        <select id="emergencyBloodGroup" required>
                            <option value="">Select Blood Group</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Hospital Name</label>
                        <input type="text" id="hospitalName" placeholder="Hospital name" required>
                    </div>
                    <div class="form-group">
                        <label>City</label>
                        <input type="text" id="emergencyCity" placeholder="City" required>
                    </div>
                    <div class="form-group">
                        <label>Contact Number</label>
                        <input type="tel" id="emergencyContact" placeholder="+91 9876543210" required>
                    </div>
                    <div class="form-group">
                        <label>Additional Details</label>
                        <textarea id="emergencyDetails" rows="3" placeholder="Urgency level, units needed, etc."></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary emergency-btn">🚨 Send Emergency Alert</button>
                </form>
                <div id="emergencyAlert" style="margin-top: 15px;"></div>
            </div>

            <!-- AI Help Section -->
            <div id="ai" class="section">
                <h2 style="margin-bottom: 20px; color: #333;">AI Assistant</h2>
                <div class="ai-section">
                    <h3>💡 Ask about Blood Donation</h3>
                    <p style="font-size: 13px; opacity: 0.9;">Get instant answers about eligibility, process, and more</p>
                </div>
                <div class="form-group">
                    <label>Your Question</label>
                    <textarea id="aiQuestion" rows="3" placeholder="E.g., Who can donate blood? What are the requirements?"></textarea>
                </div>
                <button class="btn btn-primary" onclick="askAI()">Ask AI Assistant</button>
                <div class="loader" id="aiLoader"></div>
                <div class="ai-response" id="aiResponse"></div>
            </div>
        </div>
    </div>

    <script>
        let donors = [];
        let emergencyRequests = [];

        function showTab(tabName) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const donor = {
                id: Date.now(),
                name: document.getElementById('donorName').value,
                phone: document.getElementById('donorPhone').value,
                email: document.getElementById('donorEmail').value,
                bloodGroup: document.getElementById('donorBloodGroup').value,
                city: document.getElementById('donorCity').value.toLowerCase(),
                address: document.getElementById('donorAddress').value,
                available: document.getElementById('availability').checked,
                registeredAt: new Date().toISOString()
            };

            try {
                const response = await fetch('http://localhost:3000/api/register', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(donor)
                });
                const data = await response.json();
                
                document.getElementById('registerAlert').innerHTML = 
                    `<div class="alert alert-success"> ${data.message}</div>`;
                document.getElementById('registerForm').reset();
                donors.push(donor);
            } catch (error) {
                document.getElementById('registerAlert').innerHTML = 
                    `<div class="alert alert-danger"> Error: ${error.message}</div>`;
            }
        });

        async function searchDonors() {
            const bloodGroup = document.getElementById('searchBloodGroup').value;
            const city = document.getElementById('searchCity').value.toLowerCase();
            
            if (!bloodGroup || !city) {
                document.getElementById('searchResults').innerHTML = 
                    `<div class="alert alert-danger">Please select blood group and enter city</div>`;
                return;
            }

            try {
                const response = await fetch(`http://localhost:3000/api/search?bloodGroup=${bloodGroup}&city=${city}`);
                const data = await response.json();
                
                if (data.donors.length === 0) {
                    document.getElementById('searchResults').innerHTML = 
                        `<div class="no-results"> No donors found<br>Try emergency alert to notify all nearby donors</div>`;
                } else {
                    let html = '';
                    data.donors.forEach(donor => {
                        html += `
                            <div class="donor-card">
                                <h3>${donor.name}</h3>
                                <p> ${donor.city}</p>
                                <p> ${donor.phone}</p>
                                <span class="blood-type">${donor.bloodGroup}</span>
                                <span class="status ${donor.available ? 'available' : 'busy'}">
                                    ${donor.available ? 'Available' : 'Not Available'}
                                </span>
                            </div>
                        `;
                    });
                    document.getElementById('searchResults').innerHTML = html;
                }
            } catch (error) {
                document.getElementById('searchResults').innerHTML = 
                    `<div class="alert alert-danger">Error: ${error.message}</div>`;
            }
        }

        document.getElementById('emergencyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const emergency = {
                id: Date.now(),
                patientName: document.getElementById('patientName').value,
                bloodGroup: document.getElementById('emergencyBloodGroup').value,
                hospital: document.getElementById('hospitalName').value,
                city: document.getElementById('emergencyCity').value.toLowerCase(),
                contact: document.getElementById('emergencyContact').value,
                details: document.getElementById('emergencyDetails').value,
                createdAt: new Date().toISOString()
            };

            try {
                const response = await fetch('http://localhost:3000/api/emergency', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(emergency)
                });
                const data = await response.json();
                
                document.getElementById('emergencyAlert').innerHTML = 
                    `<div class="alert alert-success"> Emergency alert sent to ${data.notifiedCount} donors!</div>`;
                document.getElementById('emergencyForm').reset();
            } catch (error) {
                document.getElementById('emergencyAlert').innerHTML = 
                    `<div class="alert alert-danger">Error: ${error.message}</div>`;
            }
        });

        async function askAI() {
            const question = document.getElementById('aiQuestion').value;
            if (!question) return;

            document.getElementById('aiLoader').style.display = 'block';
            document.getElementById('aiResponse').style.display = 'none';

            try {
                const response = await fetch('http://localhost:3000/api/ai-help', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ question })
                });
                const data = await response.json();
                
                document.getElementById('aiLoader').style.display = 'none';
                document.getElementById('aiResponse').style.display = 'block';
                document.getElementById('aiResponse').innerHTML = data.answer;
            } catch (error) {
                document.getElementById('aiLoader').style.display = 'none';
                document.getElementById('aiResponse').style.display = 'block';
                document.getElementById('aiResponse').innerHTML = 'Error connecting to AI assistant';
            }
        }
    </script>
</body>
</html>